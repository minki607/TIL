# 스코프 (Scope)

- 식별자가 유효한 범위 
- 자바스크립트 엔진이 식별자를 검색할 때 사용하는 규칙

이름이 같은 두개의 변수 중에서 어떤 변수를 참조해야 할것인지 결정하는 행위

### 스코프의 종류

- 전역 - 어디서나 참조할 수 있음 (함수 내부에서도 참조 가능)
- 지역 - 함수 몸체 내부에서 참조가능 (하위 지역 스코프에서도 유효)

함수는 중첩될 수 있으므로 함수의 지역 스코프도 중첩될 수 있음.
중첩된 모든 스코프는 하나의 계층적 구조로 연결되고 모든 지역 스코프의 최상위 스코프는 전역 스코프가 됨 (스코프 체인)

- 변수를 참조할때 변수를 참조하는 코드의 스코프에서 상위 스코프 방향으로 이동하며 변수를 검색함.
 * 상위 스코프에서 유요한 변수는 하위 스코프에서 참조가 가능하지만 하위 스코프에서 유요한 변수는 상위 스코프에서 참조가 불가능

## 함수 레벨 스코프

블록 레벨 스코프 - 모든 코드 블록이 지역 스코프로 인정
함수 레벨 스코프 - 함수 몸체만을 지역 스코프로 인정

## 렉시컬 스코프 

동적 스코프 
- 함수를 어디서 호출했는지에 따라 상위 스코프를 결정

렉시컬 스코프/정적 스코프
- 함수를 어디서 정의 했는지에 따라 함수의 상위 스코프가 결정
- 함수가 호출된 위치는 상위 스코프 결정에 영향을 주지 않음


# 전역 변수

- var 키워드로 선언한 전역 변수의 생명 주기는 전역 객체의 생명 주기와 일치
- 지역 변수의 생명 주기는 함수의 생명 주기와 일치
- 호이스팅은 스코프로 단위로 동작함

```javascript
var x = 'global';

function foo() {
  console.log(x); //여기서 전역변수 'global'이 참조 되지 않고 함수 내부에 선언된 변수x 가 스코프내에서 호이스팅되어 undefined라는 값을 가짐.
  var x = 'local'
  }
```

## 전역 변수의 문제점 

### 암묵적 결합 
- 모든 코드가 전역 변수를 참조하고 의도치 않게 변경할수 있음
### 긴 생명 주기
- 프로그램이 실행되는 동안 계속 남아있기 때문에 오랜 기간 메모리 리소스를 소비
- 변수 이름이 중복될 가능성이 있음
### 스코프 체인 상에서 종점에 존재
- 스코프 체인 제일 하위에 위치해 있는 함수에서 전역변수를 참조하려면 스코프체인을 몇단계 거쳐야 함
- 전역 변수의 검색 속도가 가장 느림
### 네임스페이스 오염
- 다른 파일 내에서 동일한 이름으로 명명된 전역 함수나 변수가 존재한다면 예쌍치 못한 결과를 초래.

## 해결책

### 즉시 실행 함수

즉시 실행 함수로 감싸면 모든 변수는 즉시 실행 함수의 지역 변수가 됨

### 네임스페이스 교체

네임스페이스 역활을 담당할 객체를 생성하고 전역변수처럼 사용

```javascript
var app = {};

app.name = "my-app";
console.log(app.name);
```

식별자 충돌을 방지하지만 여전히 객체 자제가 전역 변수에 할당됨

### 모듈 패턴

클래스를 모방해 관련있는 변수와 함수를 모아 하나의 모듈은 만드는 방법

- 네임스페이스의 오염을 막고 정보 은닉을 구현할수 있음

## ES6 모듈

- 전역 변수를 사용할 수 없다
- 파일 자체의 독자적인 모듈 스코프를 제공

```javascript
<script type ="module" src="lib.mjs"></script>
```




